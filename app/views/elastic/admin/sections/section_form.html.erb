<% url = @item.new_record? ? {:action=>"create"} : {:action=>"update",:id=>@item.id } %>

<%= form_for @item, :url=>url do |f| %>

	<%= submit_tag %>

	<h3>Section configuration</h3>

  <table class="wakeThemeForm">
  	<tr>
	    <th>Title:</th>
	 		<td> <%= f.text_field 'title', :class=>'' %> </td>
		</tr>
  	<tr>
	    <th>Key:</th>
	 		<td> <%= f.text_field 'key', :class=>'' %> <span class="em80">To generate Liquid drops within template. </td>
		</tr>
  	<tr>
	    <th>Localization:</th>
	 		<td> <%= f.select 'localization', Elastic::Section::LOCALIZATIONS %> </td>
		</tr>
	</table>


	<br/><br/>
	
	<% if @item.new_record? %>
	
	<% else %>

		<h3>Contents configuration</h3>
	
	  <table class="wakeThemeForm">
			<thead>
				<th> Id </th>
				<th> # </th>
				<th> Title </th>
				<th> #C </th>
				<th> Type </th>
				<th> Meta </th>
				<th>  </th>
				<th> Action </th>
			</thead>

			<%= f.fields_for :content_configs do |f2| %>
			  <% cc = f2.object %>
				<tr>
					<td> <%= cc.new_record? ? ico('plus') : cc.id %> </td>
					<td> <%= f2.text_field 'position', :size=>2 %> </td>
		  		<td> <%= f2.text_field :title %> </td>
					<td> <%= cc.contents.size %> </td>
	        <td> <%= f2.select :form, Elastic::ContentConfig::FORMS.keys %></td>
	        <td> 
						<% for k in Elastic::ContentConfig::FORMS[cc.form.to_sym] %>
						  <%= k %>: <%= f2.text_field "meta[#{k}]", :value=>(cc.meta||{})[k], :size=>4 %>
						<% end if cc.form %>		
					</td>
					<td> <%= link_to (cc.is_published? ? ico(:check_alt,:green) : ico(:x_alt,:red)),
					  cc_toggle_published_admin_section_path(@item, cc) if not cc.new_record? %>
					 	<!-- :action=>'cc_toggle_published', :id=>@item.id, :content_config_id=>cc.id  --></td>
					<td>
						<% if f2.object.wake_destroyable? %>
					  	<%= f2.check_box '_destroy' %> destroy 
						<% end %>
					</td>
				</tr>
			<% end %>

			<% if @item.content_configs.select{ |x| x.new_record? }.empty? %>
				<tr>
					<td> <%= ico('plus') %></td>
					<td colspan="10"> <%= link_to  'add new content', new_content_config_admin_section_path(@item) %> </td>
				</tr>
			<% end %>
		
		</table>

	<% end %>

<% end %>

	